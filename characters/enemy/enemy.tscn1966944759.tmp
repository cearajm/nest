[gd_scene load_steps=10 format=3 uid="uid://bjtabrbxneck5"]

[ext_resource type="PackedScene" uid="uid://drx2rcsrmw4sk" path="res://characters/player/nest temp.glb" id="1_wa0eo"]
[ext_resource type="Script" uid="uid://cosdpw1kvc3cv" path="res://characters/enemy/enemy_class_old.gd" id="2_fxr07"]
[ext_resource type="Script" uid="uid://dnaab58kq5kav" path="res://characters/state_machine.gd" id="3_ggbst"]
[ext_resource type="Script" uid="uid://c2lfssa12byma" path="res://characters/enemy/follow_new.gd" id="5_toq4n"]
[ext_resource type="Script" uid="uid://ds2j56q21ecgs" path="res://characters/enemy/attack_new.gd" id="5_u8tuc"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_nhupr"]
radius = 0.252031

[sub_resource type="SphereShape3D" id="SphereShape3D_1ohc2"]
radius = 1.07133

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_ggbst"]
bg_color = Color(0.841707, 0.210368, 0.261383, 1)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_toq4n"]
bg_color = Color(0.457217, 0.780075, 0.313953, 1)

[node name="enemy" type="CharacterBody3D" groups=["enemy"]]
collision_layer = 4
collision_mask = 3

[node name="nest temp" parent="." instance=ExtResource("1_wa0eo")]
transform = Transform3D(-1, 0, 1.19209e-07, 0, 1, 0, -1.19209e-07, 0, -1, 0, 0, 0)

[node name="Skeleton3D" parent="nest temp/Armature" index="0"]
bones/0/position = Vector3(0.00574136, 0.0427213, 0.0154232)
bones/0/rotation = Quaternion(0.00638231, -0.0367924, 0.131438, 0.990621)

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_nhupr")

[node name="collision area" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.05602, 0)
collision_layer = 0
collision_mask = 2

[node name="CollisionShape3D" type="CollisionShape3D" parent="collision area"]
shape = SubResource("SphereShape3D_1ohc2")

[node name="Enemy" type="Node3D" parent="." node_paths=PackedStringArray("progress_bar", "collision_area")]
unique_name_in_owner = true
script = ExtResource("2_fxr07")
progress_bar = NodePath("../MarginContainer/ProgressBar")
collision_area = NodePath("../collision area")
metadata/_custom_type_script = "uid://cosdpw1kvc3cv"

[node name="MarginContainer" type="MarginContainer" parent="."]
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -138.0
offset_bottom = 51.0
grow_horizontal = 0
size_flags_horizontal = 8

[node name="ProgressBar" type="ProgressBar" parent="MarginContainer"]
layout_mode = 2
theme_override_styles/background = SubResource("StyleBoxFlat_ggbst")
theme_override_styles/fill = SubResource("StyleBoxFlat_toq4n")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
unique_name_in_owner = true
path_height_offset = 0.1

[node name="Timer" type="Timer" parent="."]
unique_name_in_owner = true
wait_time = 2.0
autostart = true

[node name="state machine" type="Node" parent="." node_paths=PackedStringArray("starting_state", "current_state")]
unique_name_in_owner = true
script = ExtResource("3_ggbst")
starting_state = NodePath("follow")
current_state = NodePath("follow")

[node name="attack old" type="Node" parent="state machine"]

[node name="follow" type="Node" parent="state machine" node_paths=PackedStringArray("attack_state") groups=["enemy"]]
script = ExtResource("5_toq4n")
attack_state = NodePath("../attack")
metadata/_custom_type_script = "uid://nr67em11qde3"

[node name="attack" type="Node" parent="state machine" node_paths=PackedStringArray("follow_state")]
script = ExtResource("5_u8tuc")
follow_state = NodePath("../follow")
metadata/_custom_type_script = "uid://nr67em11qde3"

[connection signal="body_entered" from="collision area" to="Enemy" method="_on_collision_area_body_entered"]
[connection signal="body_exited" from="collision area" to="Enemy" method="_on_collision_area_body_exited"]
[connection signal="timeout" from="Timer" to="state machine/attack old" method="_on_timer_timeout"]

[editable path="nest temp"]
